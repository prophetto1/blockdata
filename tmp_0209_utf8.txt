28:## 0209-unified-remaining-work.md — Verified
31:- 0209-A01: staging columns on block_overlays_v2 → **DONE** — DB audit confirms overlay_jsonb_staging, overlay_jsonb_confirmed, confirmed_at, confirmed_by columns all present on block_overlays_v2
32:- 0209-A02: overlay status enum → **DONE** — DB CHECK constraint enforces pending|claimed|ai_complete|confirmed|failed; migration 009 dropped legacy `complete`
33:- 0209-A03: document schema prompt_config convention → **PARTIAL** — Convention is embedded in worker code (reads `schema_jsonb.prompt_config`) and referenced in 0209 Phase 1.3 spec, but no standalone convention doc exists
34:- 0209-A04: project_id NOT NULL on documents_v2 → **DONE** — DB audit confirms NOT NULL constraint with FK to projects
35:- 0209-A05: migration version drift reconciliation → **DONE** — Repo files renamed to match DB timestamps; 24 migrations applied cleanly
36:- 0209-A06: partial indexes on block_overlays_v2 → **DONE** — DB audit confirms idx_block_overlays_v2_pending and idx_block_overlays_v2_ai_complete partial indexes
37:- 0209-A07: stateless worker edge function → **DONE** — worker/index.ts implements claim-process-write-exit, deployed v17
38:- 0209-A08: atomic batch claim FOR UPDATE SKIP LOCKED → **DONE** — claim_overlay_batch RPC uses FOR UPDATE SKIP LOCKED; confirmed in migration 010
39:- 0209-A09: LLM call pipeline with tool_use → **DONE** — worker calls Anthropic Messages API with tool_use, cache_control ephemeral headers
40:- 0209-A10: write to overlay_jsonb_staging, update run rollup → **DONE** — Worker writes overlay_jsonb_staging, sets status ai_complete; run rollup updates completed_blocks/failed_blocks/status
41:- 0209-A11: per-block error handling and retry → **DONE** — markRetryOrFailed increments attempt_count, releases to pending if < max_retries, else marks failed
42:- 0209-A12: ANTHROPIC_API_KEY in Supabase secrets → **DONE** — Worker functions successfully; key resolution: user_api_keys → platform env → error
43:- 0209-A13: concurrent worker no double-process → **DONE** — FOR UPDATE SKIP LOCKED in claim_overlay_batch guarantees no double-processing
44:- 0209-A14: full run flow test → **PARTIAL** — Worker verified end-to-end in production; no automated integration test exists
45:- 0209-A15: Split Upload.tsx to upload-only → **DONE** — Upload.tsx is upload-only with custom dropzone, per-file status
46:- 0209-A16: Delete dead pages → **DONE** — Dashboard.tsx, Documents.tsx, RunsList.tsx not found in repo
47:- 0209-A17: catch-all redirects for old routes → **DONE** — LegacyDocumentRedirect and LegacyRunRedirect confirmed
48:- 0209-A18: Mantine Breadcrumbs → **DONE** — AppBreadcrumbs component exists and used across pages
49:- 0209-A19: route-entity membership validation → **DONE** — DocumentDetail validates project_id matches route param; mismatch triggers redirect
50:- 0209-A20: document deletion with cascade → **DONE** — delete_document RPC confirmed; cascades overlays → blocks → document
51:- 0209-A21: run deletion and cancellation → **DONE** — delete_run and cancel_run RPCs confirmed
52:- 0209-A22: schema deletion with FK guard → **DONE** — delete_schema RPC exists; FK prevents deletion when runs reference it
53:- 0209-A23: project deletion with cascade → **DONE** — delete_project RPC confirmed
54:- 0209-A24: storage cleanup on document delete → **NOT STARTED** — No storage bucket cleanup logic in edge functions; deferred
55:- 0209-A25: deletion RPCs via migration 011 → **DONE** — Migration 011 confirmed; all 5 delete RPCs present
56:- 0209-A26: merge header sections into dense bar → **DONE** — TopCommandBar is single 56px bar
57:- 0209-A27: grid fill viewport → **DONE** — BlockViewerGrid uses AG Grid with calc-based height
58:- 0209-A28: Apply Schema control → **DONE** — ProjectDetail has schema selector + "Apply to All Documents"
59:- 0209-A29: view mode toggle compact/expanded → **DONE** — BlockViewerGrid density toggle (Compact/Comfortable) persisted to localStorage
60:- 0209-A30: column visibility menu → **DONE** — AG Grid built-in column visibility
61:- 0209-A31: block type filter → **DONE** — MultiSelect filter confirmed in BlockViewerGrid
62:- 0209-A32: Mantine Dropzone → **DONE** — Upload.tsx uses custom dropzone (functionally equivalent)
63:- 0209-A33: parallel ingest with per-file status → **DONE** — Upload.tsx fires parallel ingest calls with per-file status badges
64:- 0209-A34: realtime documents_v2 → **DONE** — documents_v2 in Supabase realtime publication; ProjectDetail subscribes
65:- 0209-A35: Apply Schema to All Documents → **DONE** — ProjectDetail bulk action confirmed
66:- 0209-A36: Run All Pending → **DONE** — ProjectDetail bulk action confirmed
67:- 0209-A37: Confirm All → **DONE** — ProjectDetail bulk action confirmed; calls confirm_overlays RPC
68:- 0209-A38: Export All ZIP → **DONE** — ProjectDetail uses JSZip for per-document JSONL zip; merged JSONL/CSV not implemented
69:- 0209-A39: project-level aggregate progress → **DONE** — ProjectDetail has summary stats (confirmed/staged/pending/failed)
70:- 0209-A40: grid staging indicators → **DONE** — StatusCellRenderer renders ai_complete=yellow; visual distinction present
71:- 0209-A41: inline editing staged overlays → **DONE** — BlockViewerGrid: editable when overlay_status=ai_complete; onCellValueChanged wired
72:- 0209-A42: per-block confirm/reject controls → **DONE** — ReviewActionCellRenderer confirmed
73:- 0209-A43: bulk Confirm All Staged → **DONE** — confirm_overlays RPC + toolbar button
74:- 0209-A44: export respect confirmation status → **DONE** — export-jsonl joins confirmed overlays; unconfirmed = null user_defined
75:- 0209-A45: RLS UPDATE policy + RPC confirmation → **DONE** — RLS + confirm_overlays RPC with atomic copy + audit stamp
76:- 0209-A46: enhanced export options → **PARTIAL** — normalized/parser_native views + ZIP export; CSV and merged JSONL not implemented
77:- 0209-A47: reconstruct edge function → **NOT STARTED** — No reconstruct directory under supabase/functions/
78:- 0209-A48: reconstructed markdown download → **NOT STARTED** — Depends on A47
79:- 0209-A49: /app/integrations page → **NOT STARTED** — No integrations page in web/src/pages/
80:- 0209-A50: Neo4j integration → **NOT STARTED** — No Neo4j code in repo
81:- 0209-A51: webhook integration → **NOT STARTED** — No webhook integration code
82:- 0209-A52: DuckDB/Parquet export → **NOT STARTED** — No DuckDB/Parquet code
83:- 0209-A53: GCP conversion service 403 fix → **PARTIAL** — conversion-complete function works; underlying GCP org policy fix unclear
84:- 0209-A54: code-splitting React.lazy → **NOT STARTED** — grep for React.lazy returns zero hits
85:- 0209-A55: Vitest + RTL tests → **NOT STARTED** — No Vitest config or @testing-library dependency in web/
86:- 0209-A56: React Error Boundary, reconnection → **PARTIAL** — Realtime subscriptions exist; no ErrorBoundary component found
87:- 0209-A57: CI/CD GitHub Actions → **NOT STARTED** — .github directory does not exist
88:- 0209-A58: auth lifecycle → **PARTIAL** — Login/Register exist; GoogleAuthPanel for OAuth; full email confirm/password reset flows not verified
89:- 0209-A59: account settings page → **DONE** — Settings.tsx exists with API key management, model defaults
90:- 0209-A60: security hardening (CSP, rate limiting) → **NOT STARTED** — No CSP headers, rate limiting, or session expiry found
93:- 0209-D01: AI writes only to staging → **DONE** — Worker writes overlay_jsonb_staging only
94:- 0209-D02: export reads only confirmed → **DONE** — export-jsonl reads overlay_jsonb_confirmed
95:- 0209-D03: grid shows staging when reviewing → **DONE** — BlockViewerGrid renders based on overlay status
96:- 0209-D04: worker is stateless HTTP → **DONE** — Confirmed in worker v17
97:- 0209-D05: FOR UPDATE SKIP LOCKED → **DONE** — claim_overlay_batch RPC
98:- 0209-D06: platform API key for v1 → **SUPERSEDED** — user_api_keys table has full precedence chain
99:- 0209-D07: platform validates schema as JSON object with schema_ref → **DONE** — schemas/index.ts validates isPlainObject
100:- 0209-D08: no distinction extraction/editing schema → **DONE** — Single schema model
101:- 0209-D09: reconstruct scoped to mdast only → **N/A** — Reconstruct not built
102:- 0209-D10: revised_content field convention → **N/A** — Reconstruct not built
103:- 0209-D11: schema deletion FK guard → **DONE** — delete_schema RPC with FK constraint
104:- 0209-D12: critical path phasing → **DONE** — Priority queue executed through P1-P6
107:- 0209-P01: worker never overwrites confirmed → **DONE** — RLS + RPC design prevents writes to confirmed column
108:- 0209-P02: RLS prevents direct client updates to confirmed → **DONE** — Only confirm_overlays RPC touches confirmed
109:- 0209-P03: confirmation via RPC (atomic copy + audit stamp) → **DONE** — confirm_overlays RPC performs atomic copy
110:- 0209-P04: export only confirmed in user_defined → **DONE** — export-jsonl joins confirmed overlays
111:- 0209-P05: reject uploads without project_id → **DONE** — project_id NOT NULL constraint + ingest function validates
112:- 0209-P06: all dispatch strategies use same worker → **DONE** — Single worker function handles all invocations
113:- 0209-P07: consolidation to 0213 file → **SUPERSEDED** — tbdv2 is now canonical tracker
114:- 0209-P08: phase concurrency rules → **DONE** — Priority queue enforces sequencing
510:| 0209-unified-remaining-work.md | 52 | 7 | 9 | 4 | 72 |
